{"remainingRequest":"C:\\Users\\User\\Documents\\JATU PLC\\frontend\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\User\\Documents\\JATU PLC\\frontend\\src\\components\\forms\\PasswordResetForm.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\User\\Documents\\JATU PLC\\frontend\\src\\components\\forms\\PasswordResetForm.vue","mtime":1588543442187},{"path":"C:\\Users\\User\\Documents\\JATU PLC\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\User\\Documents\\JATU PLC\\frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\User\\Documents\\JATU PLC\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\User\\Documents\\JATU PLC\\frontend\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQoNCmltcG9ydCBVc2Vyc0FQSSBmcm9tICdAL2FwaS91c2Vycy5hcGkuanMnDQoNCmV4cG9ydCBkZWZhdWx0IHsNCg0KICAgIG5hbWU6J3Bhc3N3b3JkLXJlc2V0JywNCg0KICAgIGRhdGEoKXsNCiAgICAgICAgcmV0dXJuew0KICAgICAgICAgICAgbG9hZGluZzpmYWxzZSwNCiAgICAgICAgICAgIGVycm9yOicnLA0KICAgICAgICAgICAgcGFzc3dvcmQ6JycsDQogICAgICAgICAgICBwYXNzd29yZDI6JycNCiAgICAgICAgfQ0KICAgIH0sDQoNCiAgICBtZXRob2RzOnsNCg0KICAgICAgICBhc3luYyBzdWJtaXQoKXsNCiAgICAgICAgICAgIHRoaXMubG9hZGluZyA9ICF0aGlzLmxvYWRpbmcNCiAgICAgICAgICAgIGxldCB1c2VyID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnYWN0aXZlVXNlcicpKQ0KICAgICAgICAgICAgY29uc29sZS5sb2codXNlcikNCiAgICAgICAgICAgIGlmKCF1c2VyKXsNCiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy4kcm91dGVyLnB1c2goJ2xvZ2luJykNCiAgICAgICAgICAgIH1lbHNlew0KICAgICAgICAgICAgICAgIGlmKHRoaXMucGFzc3dvcmQgIT0gdGhpcy5wYXNzd29yZDIpew0KICAgICAgICAgICAgICAgICAgICB0aGlzLmVycm9yID0gJ1Bhc3N3b3JkcyBkbyBub3QgbWF0Y2gnDQogICAgICAgICAgICAgICAgICAgIHRoaXMubG9hZGluZyA9ICF0aGlzLmxvYWRpbmcNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMucmVzZXQoKQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBsZXQgZGF0YSA9IHsNCiAgICAgICAgICAgICAgICAgICAgcGFzc3dvcmQ6dGhpcy5wYXNzd29yZA0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBsZXQgcmVzdWx0cyA9IGF3YWl0IFVzZXJzQVBJLnJlc2V0UGFzc3dvcmQodXNlci5faWQsIGRhdGEpDQogICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3Jlc3BvbnNlIGZyb20gc2VydmVyIDo+PicsIHJlc3VsdHMpDQogICAgICAgICAgICAgICAgaWYoIXJlc3VsdHMudXNlcil7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZXJyb3IgPSByZXN1bHRzLm1lc3NhZ2UNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2FkaW5nID0gIXRoaXMubG9hZGluZw0KICAgICAgICAgICAgICAgICAgICB0aGlzLnJlc2V0KCkNCiAgICAgICAgICAgICAgICB9ZWxzZXsNCiAgICAgICAgICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oJ2FjdGl2ZVVzZXInKQ0KDQogICAgICAgICAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdhY3RpdmVVc2VyJywgSlNPTi5zdHJpbmdpZnkocmVzdWx0cy51c2VyKSkNCg0KICAgICAgICAgICAgICAgICAgICB0aGlzLmxvYWRpbmcgPSAhdGhpcy5sb2FkaW5nDQogICAgICAgICAgICAgICAgICAgIHRoaXMucmVzZXQoKQ0KICAgICAgICAgICAgICAgICAgICB0aGlzLiRyb3V0ZXIucHVzaCh7IG5hbWU6J2hvbWUnfSkNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQoNCiAgICAgICAgcmVzZXQoKXsNCiAgICAgICAgICAgIHRoaXMucGFzc3dvcmQgPSAnJywNCiAgICAgICAgICAgIHRoaXMucGFzc3dvcmQyID0gJycNCiAgICAgICAgfQ0KICAgIH0NCg0KfQ0K"},{"version":3,"sources":["PasswordResetForm.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;AA0BA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA","file":"PasswordResetForm.vue","sourceRoot":"src/components/forms","sourcesContent":["<template>\r\n  <div class=\"password-reset-wrapper\">\r\n      <b-form @submit.prevent='submit'>\r\n\r\n          <b-form-group label='Password'>\r\n              <b-form-input type='password' v-model=\"password\" placeholder='Enter your new password'></b-form-input>\r\n          </b-form-group>\r\n\r\n          <b-form-group label='Confirm Password'>\r\n              <b-form-input type='password' v-model=\"password2\" placeholder='Confirm your new password'></b-form-input>\r\n          </b-form-group>\r\n\r\n          <b-button block type=\"submit\" variant=\"primary\">\r\n                <template v-if=\"loading\">\r\n                    <b-spinner small type=\"grow\"></b-spinner>\r\n                    Loading...\r\n                </template>\r\n                <template v-else>Save</template>\r\n        </b-button>\r\n\r\n      </b-form>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n\r\nimport UsersAPI from '@/api/users.api.js'\r\n\r\nexport default {\r\n\r\n    name:'password-reset',\r\n\r\n    data(){\r\n        return{\r\n            loading:false,\r\n            error:'',\r\n            password:'',\r\n            password2:''\r\n        }\r\n    },\r\n\r\n    methods:{\r\n\r\n        async submit(){\r\n            this.loading = !this.loading\r\n            let user = JSON.parse(localStorage.getItem('activeUser'))\r\n            console.log(user)\r\n            if(!user){\r\n                return this.$router.push('login')\r\n            }else{\r\n                if(this.password != this.password2){\r\n                    this.error = 'Passwords do not match'\r\n                    this.loading = !this.loading\r\n                    return this.reset()\r\n                }\r\n                let data = {\r\n                    password:this.password\r\n                }\r\n                let results = await UsersAPI.resetPassword(user._id, data)\r\n                console.log('response from server :>>', results)\r\n                if(!results.user){\r\n                    this.error = results.message\r\n                    this.loading = !this.loading\r\n                    this.reset()\r\n                }else{\r\n                    localStorage.removeItem('activeUser')\r\n\r\n                    localStorage.setItem('activeUser', JSON.stringify(results.user))\r\n\r\n                    this.loading = !this.loading\r\n                    this.reset()\r\n                    this.$router.push({ name:'home'})\r\n                }\r\n            }\r\n        },\r\n\r\n        reset(){\r\n            this.password = '',\r\n            this.password2 = ''\r\n        }\r\n    }\r\n\r\n}\r\n</script>\r\n\r\n<style>\r\n\r\n</style>"]}]}